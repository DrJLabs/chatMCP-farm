# --- Keycloak / OAuth ---
# Keep confidential values (client credentials) inside .keycloak-env and source them when running scripts.
KEYCLOAK_REALM=OMA
GITHUB_MCP_SERVICE_NAME=github-mcp
GITHUB_MCP_SERVICE_NAME_HUMAN="github-mcp service"
GITHUB_MCP_SERVICE_NAME_MODEL=github-mcp
GITHUB_MCP_SERVICE_DESCRIPTION="Describe your github-mcp service"
# Update the issuer and public URLs to match your deployment
OIDC_ISSUER=https://oauth.example.com/auth/realms/OMA
OIDC_AUDIENCE=https://mcp-service.example.com/mcp

# --- Networking & Compose (override as needed) ---
# Set COMPOSE_PROFILES=github-mcp in CI or automation to keep the service opt-in.
PORT=8770
MCP_BIND_HOST=0.0.0.0
MCP_PUBLIC_HOST=mcp-service.example.com
MCP_PUBLIC_BASE_URL=https://mcp-service.example.com/mcp
PRM_RESOURCE_URL=https://mcp-service.example.com/mcp
MCP_ALLOWED_ORIGINS=https://chat.openai.com,https://chatgpt.com
REQUIRE_AUTH=true
ENABLE_STREAMABLE=true
ENABLE_SSE=false
DEBUG_HEADERS=false
MCP_CPU_LIMIT=0.50
MCP_MEMORY_LIMIT=256M
MCP_MEMORY_RESERVATION=128M
MCP_NETWORK_EXTERNAL=traefik
MCP_BUILD_CONTEXT=..
MCP_DOCKERFILE=services/github-mcp/Dockerfile

# --- GitHub MCP Bridge ---
# When set, routes /mcp traffic through the bridge container.
MCP_UPSTREAM_URL=http://github-mcp-bridge:9090/mcp
MCP_UPSTREAM_HEALTH_URL=http://github-mcp-bridge:9300/healthz
MCP_UPSTREAM_METRICS_URL=http://github-mcp-bridge:9300/metrics
MCP_BRIDGE_LOG_FILE=/var/log/bridge/bridge.log
MCP_BRIDGE_LOG_TAIL_BYTES=65536
MCP_PROTOCOL_VERSION=2025-06-18

# Bridge build/runtime pins
GITHUB_MCP_SERVER_VERSION=0.15.0
GITHUB_MCP_SERVER_SHA256=14b72ee93f2adfbe330be116bc2387845ab2c46b9e686e5659214d7fe75a422b
MCP_PROXY_VERSION=5.6.1
MCP_BRIDGE_NODE_IMAGE=20.17.0-alpine3.20
MCP_BRIDGE_PORT=9090
MCP_BRIDGE_METRICS_PORT=9300
MCP_BRIDGE_LOG_VOLUME=github-mcp-bridge-logs

# GitHub authentication (PAT or app token scoped for MCP tools)
GITHUB_TOKEN=ghp_your_personal_access_token
GITHUB_MCP_SERVER_ARGS=--dynamic-toolsets

# Derived manifest overrides (optional)
MCP_SERVER_NAME=github-mcp
MCP_SERVER_VERSION=0.1.0
MCP_NAME_HUMAN=${GITHUB_MCP_SERVICE_NAME_HUMAN}
MCP_NAME_MODEL=${GITHUB_MCP_SERVICE_NAME_MODEL}
MCP_DESCRIPTION_HUMAN=${GITHUB_MCP_SERVICE_DESCRIPTION}
MCP_DESCRIPTION_MODEL=${GITHUB_MCP_SERVICE_DESCRIPTION}

# Stream security defaults are driven by MCP_ALLOWED_ORIGINS

# Reference the shared Keycloak environment helper if present
# source ../../.keycloak-env
