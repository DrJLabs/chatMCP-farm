# Story 2.3: Refresh Service Template for Express 5 Baseline

## Status
Draft

## Story
**As a** developer bootstrapping new MCP services,
**I want** the `templates/service` scaffold to match the Express 5 + Vitest 3 baseline,
**so that** future services launch without retrofitting dependency upgrades.

## Acceptance Criteria
1. Template `package.json`, `tsconfig`, Vitest config, and smoke scripts mirror the Express 5/Vitest 3 stack introduced in Stories 2.1 and 2.2. [Source: docs/stories/epic-dependency-alignment.md#stories]
2. Generated README, `.env.example`, and compose snippet reference Express 5, MCP SDK 1.18.x, and updated rollback/test guidance. [Source: docs/architecture/source-tree.md#source-tree-reference]
3. Template smoke/test commands run cleanly on Node 22 via `npm run lint|test|build --workspace templates-service-demo` (or equivalent scaffold verification). [Source: docs/architecture.md#9-testing-strategy]
4. Story notes explicitly acknowledge that Story 2.4 (auth-kit peers) may need to land before this work if peer warnings block template usage; if skipped, record in follow-ups. [Source: docs/stories/epic-dependency-alignment.md#stories]

## Tasks / Subtasks
- [ ] Review Stories 2.1/2.2 completion notes to capture dependency versions and testing expectations (AC: 1, 3).
- [ ] Update `templates/service/package.json`, `tsconfig`, Vitest config, and smoke script to Express 5 + Vitest 3 defaults (AC: 1).
- [ ] Align template README, `.env.example`, and compose snippet with new baseline and rollback instructions (AC: 2).
- [ ] Generate a sample scaffold (e.g., via `scripts/bootstrap.sh`) and run lint/test/build/smoke commands to validate the template changes (AC: 3).
- [ ] If Story 2.4 has not landed, document the sequencing note (template may emit peer warnings) in follow-ups and README (AC: 4).

## Dev Notes
- **Sequence Note:** If `mcp-auth-kit` still advertises Express 4 peers, defer template publication until Story 2.4 resolves the mismatch or document the temporary warning prominently. [Source: docs/stories/epic-dependency-alignment.md#stories]
- **Reference Baseline:** Mirror dependency versions and Vitest coverage thresholds established in Story 2.2 (`services/github-mcp`). [Source: docs/stories/2.2.upgrade-github-mcp-deps.md#dev-notes]
- **Template Assets:** Changes apply under `templates/service/` and must remain compatible with `scripts/bootstrap.sh`. [Source: docs/architecture/source-tree.md#source-tree-reference]
- **Testing Requirements:** Use generated scaffold to validate lint/test/build/smoke flows on Node 22, matching architecture testing strategy. [Source: docs/architecture.md#9-testing-strategy]

## Testing
- Scaffold a demo service via `scripts/bootstrap.sh` and run `npm run lint|test|build` within the generated workspace.
- Execute template smoke script (documentation or script output) to confirm Streamable HTTP behaviour.
- Ensure any residual peer warnings are documented if Story 2.4 is pending.

## Change Log
| Date       | Version | Description                                           | Author |
|------------|---------|-------------------------------------------------------|--------|
| 2025-09-24 | 0.1     | Initial draft capturing Express 5 template refresh. | Codex |

## Dev Agent Record
### Agent Model Used

### Debug Log References

### Completion Notes List

### File List

## QA Results
- Pending.
