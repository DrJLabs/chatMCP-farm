# NFR Assessment: 2.3 – Refresh Service Template for Express 5 Baseline

Date: 2025-09-24  
Reviewer: Quinn (Test Architect)

## Summary

- Security: PASS – Template retains `mcp-auth-kit` middleware ordering and Supertest diagnostics exercises 401/400 paths after the Express 5 refresh.
- Performance: PASS – Vitest 3.2 V8 coverage run completes in ~1.3s with AST-aware remapping enabled; no regression relative to Story 2.2 baselines.
- Reliability: PASS – Bootstrap workflow (`lint`, `test`, `build`, `smoke`) plus `npm run postbump:test` all succeed on Node 22, confirming deterministic setup.
- Maintainability: PASS – Updated README/.env/compose guidance, lint script, and coverage thresholds keep the template aligned with workspace standards; coverage report stays above 85% lines.

## Evidence & Notes

### Security
- Supertest suite (`test/accept-header.spec.ts`, `test/diagnostics.spec.ts`, `test/manifest.spec.ts`) passes under Express 5 with `npm run test -- --coverage --workspace services/express5-demo`.
- Smoke test against local server (`npm run smoke --workspace services/express5-demo`) confirms auth guard returns 406/400 for unsupported flows and surfaces session headers when successful.

### Performance
- Vitest execution time recorded at 1.31s with V8 coverage (see command above); AST-aware remapping enabled in `templates/service/vitest.config.ts`.
- No observed increase versus prior story baselines; continue to monitor once multiple scaffolds exist.

### Reliability
- Bootstrap commands (`npm run lint|test|build|smoke --workspace services/express5-demo`) and `npm run postbump:test` executed sequentially without failures.
- `npm ls express --workspace services/express5-demo` shows clean dependency tree, avoiding peer warning churn.

### Maintainability
- Template docs reference Express 5, `postbump:test`, and rollback guidance; `scripts/bootstrap.sh` prompts engineers to run the full workflow.
- TypeScript configs and lint script align with monorepo standards, preventing drift for new services.

## Quick Follow-ups
- Monitor Vitest coverage runtime in CI once multiple scaffolds adopt the template; current numbers are healthy.
- Keep security smoke assertions updated if `mcp-auth-kit` introduces new headers or scopes.

NFR assessment: qa.qaLocation/assessments/2.3-nfr-20250924.md
