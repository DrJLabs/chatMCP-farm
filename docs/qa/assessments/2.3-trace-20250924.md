# Requirements Traceability Matrix

## Story: 2.3 – Refresh Service Template for Express 5 Baseline

### Coverage Summary

- Total Requirements: 4
- Fully Covered: 4 (100%)
- Partially Covered: 0 (0%)
- Not Covered: 0 (0%)

### Requirement Mappings

#### AC1: Template assets mirror Express 5 / Vitest 3 baseline, expose lint/test/build/smoke scripts, and produce a single Express 5 dependency tree
**Coverage: FULL**

- **Command Evidence**: `npm run lint --workspace services/express5-demo` — validates `lint` script and TypeScript config alignment.
  - Given: Scaffold generated via `scripts/bootstrap.sh express5-demo`
  - When: Running the lint script in the scaffold workspace
  - Then: TypeScript no-emit succeeds, proving the script exists and compiles with updated configs.
- **Command Evidence**: `npm run test -- --coverage --workspace services/express5-demo` (Vitest 3.2 with V8 coverage)
  - Given: Scaffold with Express 5 dependencies
  - When: Executing the coverage suite
  - Then: Vitest reports provider `v8` with AST-aware remapping and passes all template tests, confirming runtime parity.
- **Command Evidence**: `npm ls express --workspace services/express5-demo`
  - Given: Installed scaffold dependencies
  - When: Listing express dependency tree
  - Then: Only `express@5.1.0` appears (deduped) with no Express 4 remnants.

#### AC2: Template docs/configs reference Express 5 baseline and the `postbump:test` helper with rollback guidance
**Coverage: FULL**

- **Documentation Verification**: Updated `templates/service/README.md`, `.env.example`, and `compose.yml`
  - Given: Rendered documentation after template refresh
  - When: Reviewing references to Express 5, `postbump:test`, and rollback steps
  - Then: All artifacts mention the new baseline and workflow, satisfying documentation alignment.
- **Command Evidence**: `scripts/bootstrap.sh express5-demo`
  - Given: Developer runs bootstrap script
  - When: Script completes and prints next steps
  - Then: Output enumerates lint/test/build/smoke/postbump commands, reinforcing documentation.

#### AC3: Bootstrap flow succeeds (lint, test, build, smoke, postbump) on Node 22 with captured evidence
**Coverage: FULL**

- **Command Evidence**: `npm run lint|test|build|smoke --workspace services/express5-demo`
  - Given: Fresh scaffold on Node 22 environment
  - When: Running sequential commands from README guidance
  - Then: Each command completes successfully; smoke test logs successful initialize response.
- **Command Evidence**: `npm run postbump:test`
  - Given: Workspace root after scaffold install
  - When: Running regression helper
  - Then: Helper executes service-level suites (express5-demo, github-mcp, mcp-test-server) without failures.

#### AC4: Story notes document sequencing with `mcp-auth-kit` peer updates and lack of new warnings/follow-ups
**Coverage: FULL**

- **Manual Review**: Dev Agent Record completion notes and follow-up log
  - Given: Story file updated post-implementation
  - When: Reviewing Dev Agent Record and `docs/stories/follow-ups.md`
  - Then: Notes confirm alignment with `mcp-auth-kit` peer range and no new warnings, so no additional follow-up entries required.
- **Command Evidence**: `npm ls express --workspace services/express5-demo`
  - Given: Peer dependency check
  - When: Inspecting dependency graph
  - Then: No peer warnings reported, demonstrating sequencing success.

### Critical Gaps

_None identified. All acceptance criteria currently carry full coverage._

Traceability report: qa.qaLocation/assessments/2.3-trace-20250924.md
