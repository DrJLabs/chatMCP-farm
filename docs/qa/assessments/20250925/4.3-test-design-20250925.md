# Test Design: Story 4.3

Date: 2025-09-25
Designer: Quinn (Test Architect)

## Test Strategy Overview
- Total Test Scenarios: 8
- Unit/Static Checks: 3 (38%)
- Integration/Doc Review: 3 (38%)
- E2E/Operational Dry Runs: 2 (24%)
- Priority Mix: P0 â€“ 4, P1 â€“ 3, P2 â€“ 1, P3 â€“ 0

## Test Scenarios by Acceptance Criteria

### AC1 â€“ Runbook documents prerequisites, configuration, and bring-up workflow

| ID           | Level     | Priority | Test | Justification |
|--------------|-----------|----------|------|---------------|
| 4.3-UNIT-001 | Static    | P0       | Markdown lint/assertion ensures runbook header, prerequisites list, and configuration table exist with expected keys (`FS_ALLOWED`, `ALLOW_WRITE`, `ENABLE_ROOTS`, `SSE_PORT`). | Guarantees core content is present before manual review, mitigating TECH-4.3-001. |
| 4.3-INT-001  | Doc Review| P0       | Manual QA review verifies bring-up workflow references `scripts/compose.sh --profile filesystem-mcp config/up` and `logs` commands with capture guidance. | Confirms operators receive actionable steps for initial enablement (OPS-4.3-001).

### AC2 â€“ Runbook captures security posture and approval workflow for write toggles

| ID           | Level     | Priority | Test | Justification |
|--------------|-----------|----------|------|---------------|
| 4.3-UNIT-002 | Static    | P0       | Grep/lint rule checks for presence of approval checklist keywords (`PO`, `QA`, `SEC-4.2-001`, `ALLOW_WRITE=true`). | Ensures documentation explicitly restates approval gating (SEC-4.3-001).
| 4.3-INT-002  | Doc Review| P1       | Manual review confirms Â§5 outlines step-by-step approval workflow, evidence logging, and residual risk callouts. | Validates narrative clarity beyond keyword presence.

### AC3 â€“ Validation steps enumerate compose dry-run, smoke test, logs, and teardown evidence

| ID           | Level     | Priority | Test | Justification |
|--------------|-----------|----------|------|---------------|
| 4.3-INT-003  | Doc Review| P0       | Review ensures validation checklist lists compose `config`, compose logs, smoke script, and teardown commands with guidance on storing evidence. | Guarantees operators capture artifacts required by QA gates (OPS-4.3-001).
| 4.3-E2E-001  | Operational| P1      | Execute runbook commands in staging sandbox, attach outputs (config diff, log snippet, smoke results) to Dev Notes for verification. | Confirms instructions work as written and produce expected outputs.

### AC4 â€“ Cross-references added to supporting runbooks/checklists

| ID           | Level  | Priority | Test | Justification |
|--------------|--------|----------|------|---------------|
| 4.3-UNIT-003 | Static | P1       | `rg`/lint check ensuring `docs/runbooks/compose-and-docs.md` and `docs/bootstrap-checklist.md` mention `docs/runbooks/filesystem-mcp.md`. | Prevents regression of TECH-4.3-001 cross-reference requirement.
| 4.3-E2E-002  | Operational | P2    | Follow bootstrap checklist + compose runbook flow to ensure cross-linked instructions lead operators to filesystem guide without ambiguity. | Validates operator experience end-to-end.

## Risk Coverage Mapping
- **SEC-4.3-001** mitigated by 4.3-UNIT-002 and 4.3-INT-002 (approval workflow presence + clarity) plus 4.3-E2E-001 verifying enforcement in practice.
- **OPS-4.3-001** mitigated by 4.3-INT-001, 4.3-INT-003, and 4.3-E2E-001 (bring-up steps, evidence checklist, execution proof).
- **TECH-4.3-001** mitigated by 4.3-UNIT-001, 4.3-UNIT-003, and 4.3-E2E-002 (structure validation, cross-reference checks, doc navigation review).

## Recommended Execution Order
1. Run static checks (4.3-UNIT-001/002/003) via documentation lint pipeline.
2. Perform doc reviews (4.3-INT-001/002/003) to validate narrative accuracy and evidence instructions.
3. Execute operational dry runs (4.3-E2E-001/002) in a sandbox to confirm the guidance yields expected outputs and navigation flows.

Test design matrix stored at docs/qa/assessments/20250925/4.3-test-design-20250925.md
P0 Scenarios: 4

## Notes
- Consider adding automated markdown checks (mdlint or custom script) to enforce keyword presence for approval workflows.
- Capture runbook-driven execution evidence in the storyâ€™s Dev Notes and QA gate for traceability.

## ðŸ”¬ Research & Validation Log
- 2025-09-25: Reviewed Docker Compose documentation to reconfirm `COMPOSE_PROFILES` activation pattern for optional services, ensuring AC1/AC3 instructions remain accurate. [Research: Docker Docs â€“ "Use service profiles" (accessed 2025-09-25)]
- 2025-09-25: Revisited Docker bind mount security practices to ensure runbook approval workflow emphasises read-only defaults and explicit overrides. [Research: Docker Docs â€“ "Bind mounts" (accessed 2025-09-25)]
- 2025-09-25: Consulted internal BMAD QA guidance on evidence attachment expectations to structure validation checklist and test cases. [Research: docs/runbooks/compose-and-docs.md]
