# Requirements Traceability Matrix

## Story: 3.1 – GitHub MCP Bridge Integration

Date: 2025-09-25  
Analyst: Quinn (Test Architect)

### Coverage Summary
- Total Requirements: 5
- Fully Covered: 5 (100%)
- Partially Covered: 0 (0%)
- Not Covered: 0 (0%)

### Requirement Mappings

#### AC1 – Bridge Dockerfile bundles github-mcp-server v0.15.0 and mcp-proxy@5.6.1 with published hashes
- **Coverage:** Full
- **Evidence / Tests:**
  - `COMPOSE_PROFILES=github-mcp ./scripts/compose.sh up --build -d` rebuilt the bridge image, replaying checksum verification output for `github-mcp-server_Linux_x86_64.tar.gz` (SHA256 `14b72e…`) and installing `mcp-proxy@5.6.1` before container start. (3.1-INT-001)
  - Bridge container reached healthy state with PAT-authenticated proxy, confirming build artefacts runnable.

#### AC2 – Compose profile wires bridge dependency and upstream URL without leaking Traefik settings
- **Coverage:** Full
- **Evidence / Tests:**
  - `COMPOSE_PROFILES=github-mcp ./scripts/compose.sh config` confirms the bridge service only materialises under the profile with shared log volume and no Traefik labels. (3.1-INT-002)
  - Profile bring-up (`COMPOSE_PROFILES=github-mcp ./scripts/compose.sh up --build -d`) started the bridge first, reported healthy, and then launched the primary service consuming the upstream URLs. (3.1-INT-003)

#### AC3 – Express proxy forwards headers to upstream and retains local fallback
- **Coverage:** Full
- **Evidence / Tests:**
  - `services/github-mcp/test/proxy.spec.ts` validates header propagation, log tail endpoint, and bridge status sampling with mocked upstream responses. (unit)
  - The parity harness (`npx tsx …`) captured a 200 `tools/list` response routed through the upstream stub, confirming proxy usage in practice.

#### AC4 – Environment templates and README document bridge variables and PAT usage
- **Coverage:** Full
- **Evidence / Tests:**
  - `.env.example` lists `MCP_UPSTREAM_URL`, PAT guidance (`GITHUB_TOKEN`), binary pins, and observability endpoints; README instructions explain PAT scopes and compose profile activation. (manual)
  - Lint/test run (`npm run lint|test --workspace github-mcp`) stayed green after doc updates, preventing regressions.

#### AC5 – Validation workflow covers parity and rollback smokes with evidence logged in Dev Agent Record
- **Coverage:** Full
- **Evidence / Tests:**
  - Container parity: after profile bring-up (auth disabled for smoke), in-container Node script executed `initialize`/`tools.list`, returning SSE tool listings (`add_comment_to_pending_review`, `repos.get_content`, etc.) via upstream GitHub MCP server. Results logged in Dev Agent Record alongside bridge metrics sample (`bridge_process_up 1`).
  - Fallback harness (env without upstream) retained 406/400 responses, demonstrating rollback semantics and recorded earlier in Dev Agent Record.

### Coverage Gaps
- None.

### Trace Gate Snippet
```yaml
trace:
  totals:
    requirements: 5
    full: 5
    partial: 0
    none: 0
  planning_ref: docs/qa/assessments/3.1-test-design-20250925.md
  uncovered: []
  notes: docs/qa/assessments/3.1-trace-20250925.md
```

**Hook:** `Trace matrix: docs/qa/assessments/3.1-trace-20250925.md`
