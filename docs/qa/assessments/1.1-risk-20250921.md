# Risk Profile: Story 1.1

Date: 2025-09-21
Reviewer: Quinn (Test Architect)

## Executive Summary

- Total Risks Identified: 4
- Critical Risks: 0
- High Risks: 1
- Risk Score: 78/100

Story 1.1 introduces a new MCP service scaffold that touches authentication, container orchestration, and streaming transport defaults. The primary exposure lies in mishandled OAuth credentials; other risks are medium or low once documentation and resource guardrails land.

## Critical Risks Requiring Immediate Attention

_No critical (score 9) risks identified._

## Risk Distribution

### By Category

- Security: 2 risks (0 critical)
- Technical: 1 risk (0 critical)
- Operational: 1 risk (0 critical)
- Performance: 0 risks
- Data: 0 risks
- Business: 0 risks

### By Component

- Service scaffold/backend: 3 risks
- Infrastructure (docker-compose): 1 risk
- Documentation/onboarding: 1 risk (overlaps with operational component)

## Detailed Risk Register

| Risk ID  | Category   | Description                                                                 | Probability | Impact | Score | Priority |
|----------|------------|-----------------------------------------------------------------------------|-------------|--------|-------|----------|
| SEC-001  | Security   | OAuth client secrets accidentally committed or logged during scaffold work | Medium (2)  | High (3) | 6   | High     |
| TECH-001 | Technical  | Port or dependency misconfiguration breaks existing compose stack          | Medium (2)  | Medium (2) | 4 | Medium   |
| OPS-001  | Operational| README/env guidance insufficient, leading to misconfigured deployment      | Medium (2)  | Medium (2) | 4 | Medium   |
| SEC-002  | Security   | Origin allow-list misconfigured, exposing service to untrusted callers     | Low (1)     | High (3) | 3 | Low      |

### Mitigations & Testing Focus

- **SEC-001** (Preventive): keep `.env.example` secret-only placeholders, document secret storage process, add `.gitignore` coverage; add lint/check to block accidental commits. _Testing focus_: manual review of repo history, secret scanning, ensure startup logs redact sensitive fields.
- **TECH-001** (Preventive/Detective): assign unique service port and health check; run `scripts/compose.sh` aggregation locally; add lint/test verifying snippet inclusion toggles. _Testing focus_: dry-run compose with and without new service, verify other active services remain unaffected.
- **OPS-001** (Preventive): expand README with explicit enable/disable steps, Keycloak client creation instructions, and rollback notes. _Testing focus_: follow docs from clean environment to ensure reproducibility.
- **SEC-002** (Preventive): default allowed origins to localhost, require explicit override; add unit tests around origin filter; document security review before production overrides. _Testing focus_: simulated requests with disallowed origins, ensure 403.

## Risk-Based Testing Strategy

### Priority 1: Critical Risk Tests

_No critical risks identified; focus shifts to High risks below._

### Priority 2: High Risk Tests

- Perform automated secret scanning (e.g., `gitleaks`) after scaffold copy.
- Review `.env` handling and ensure logging never echoes sensitive values sourced from `.keycloak-env`.
- Validate Keycloak client creation script keeps `.keycloak-env` secrets out of the repo.

### Priority 3: Medium/Low Risk Tests

- Compose aggregation smoke test with service enabled/disabled.
- Documentation dry run: new engineer follows README to bootstrap service.
- Unit/integration tests for origin enforcement (positive/negative cases).

## Risk Acceptance Criteria

### Must Fix Before Production

- SEC-001 mitigation actions implemented (no secrets in repo/logs).
- Compose configuration validated to prevent downtime (TECH-001).

### Can Deploy with Mitigation

- OPS-001 acceptable once README validated and monitored via onboarding feedback.
- SEC-002 acceptable with strict defaults and automated tests guarding overrides.

### Accepted Risks

- None at this stage; revisit after implementation if constraints emerge.

## Monitoring Requirements

- Run secret-scanning in CI for the new service.
- Add compose health checks and alerting for service startup failures.
- Track unauthorized origin access attempts once production telemetry is available.

## Risk Review Triggers

- Keycloak configuration changes (client type, redirect URIs).
- Introduction of additional transports (SSE/WebSocket).
- Changes to docker-compose aggregation affecting service ordering.
- New consumers (ChatGPT manifest updates) requiring broader origin access.
