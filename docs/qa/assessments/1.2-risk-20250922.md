# Risk Profile: Story 1.2

Date: 2025-09-22
Reviewer: Quinn (Test Architect)

## Executive Summary

- Total Risks Identified: 4
- Critical Risks: 0
- High Risks: 1
- Medium Risks: 3
- Risk Score: 70/100

Story 1.2 introduces manifest/PRM changes and new diagnostics output that directly affect our ChatGPT Developer Mode integration. The main compatibility risk is that OpenAI guidance still highlights `search` and `fetch` tools; if we skip the stubs, the experience may degrade when OpenAI tightens validation. Additional high/medium risks focus on misconfigured env-driven metadata and inadvertent exposure of token claims.

## High Risks Requiring Immediate Attention

### 1. BUS-001: Connector experience degrades if `search`/`fetch` stubs absent

**Score:** 6 (High)

- **Probability:** Medium — Connectors currently tolerate the omission, but guidance suggests the requirement may return.
- **Impact:** High — If validation tightens, connectors could surface warnings or fail to enable advanced tools, undermining the story goal.
- **Mitigation:** Ship lightweight `search`/`fetch` stubs that delegate to existing diagnostics or explicitly record a follow-up work item accepted by the Product Owner; add smoke verification that the manifest lists these tools. **Testing Focus:** Manifest snapshot tests and connector smoke run while stubs are active.

## Risk Distribution

### By Category

- Business: 1 risk (0 critical)
- Technical: 1 risk (1 high)
- Security: 1 risk (0 critical)
- Operational: 1 risk (0 critical)
- Performance/Data: 0 risks

### By Component

- Backend service: 4 risks (manifest, diagnostics, env handling, release process)

## Detailed Risk Register

| Risk ID  | Category  | Description                                                                                               | Probability | Impact | Score | Priority | Mitigation Highlights                                                                                              |
|----------|-----------|-----------------------------------------------------------------------------------------------------------|-------------|--------|-------|----------|--------------------------------------------------------------------------------------------------------------------|
| BUS-001  | Business  | OpenAI guidance still recommends `search`/`fetch`; skipping stubs could cause warnings or future rejection. | Medium (2)  | High (3) | 6   | High     | Implement minimal compliant stubs now or document/accept a follow-up task with owner and deadline in `docs/stories/follow-ups.md`.                |
| TECH-001 | Technical | Env-driven manifest may not match deployed URL or transport flags, causing OAuth mismatch.               | Medium (2)  | High (3) | 6   | High     | Add config validation plus smoke test that asserts manifest/PRM match env; document copy/paste curl workflow.     |
| SEC-001  | Security  | Diagnostics endpoint could leak sensitive JWT details if it logs/returns raw tokens or unexpected claims. | Medium (2)  | Medium (2) | 4 | Medium   | Limit response fields (sub, aud[], exp, origin), prevent raw token logging, and cover with contract tests.        |
| OPS-001  | Operational | Solo maintainer may skip lint/smoke runs, allowing regressions into compose profile.                      | Medium (2)  | Medium (2) | 4 | Medium   | Automate lint + smoke checklist in npm scripts; enforce via story acceptance and lightweight CI hook.             |

## Risk-Based Testing Strategy

### Priority 1: High Risk Tests
- Verify manifest lists `search`/`fetch` tools when stubs enabled.
- Run ChatGPT connector smoke (or documented manual steps) to confirm behaviour.

### Priority 2: Supporting High/Medium Risk Tests
- Automated curl smoke verifying manifest/PRM resource URL matches env.
- Negative test: mis-set env triggers validation failure before start.

### Priority 3: Medium/Low Risk Tests
- Diagnostics contract unit test to ensure redacted payload.
- Lint/build pipeline enforcement and compose dry-run.

## Risk Acceptance Criteria

- **Must Fix Before Production:** TECH-001 (and BUS-001 unless the team agrees to defer with explicit owner/date).
- **Can Deploy with Mitigation:** SEC-001 (with redaction + tests), OPS-001 (with scripted lint/smoke gate).
- **Accepted Risks:** None.

## Monitoring Requirements

- Track connector setup attempts and failures once telemetry exists.
- Capture manifest/PRM curl results in release checklist.
- Monitor service logs for diagnostics payload anomalies.

## Risk Review Triggers

- OpenAI revises MCP connector requirements.
- Additional diagnostics tools are added.
- We expose more token metadata or move beyond localhost bindings.

---

**Gate Summary Snippet**

```yaml
risk_summary:
  totals:
    critical: 0
    high: 1
    medium: 3
    low: 0
  highest:
    id: BUS-001
    score: 6
    title: Connector experience degrades if search/fetch stubs absent
  recommendations:
    must_fix:
      - Implement compliant search/fetch stubs or secure explicit waiver with follow-up owner
      - Add manifest/PRM validation tied to env config
    monitor:
      - Ensure diagnostics responses remain redacted via contract tests
      - Keep lint + smoke scripts in acceptance checklist for solo maintainer
```

**Trace Hook**

```
Risk profile: docs/qa/assessments/1.2-risk-20250922.md
```
